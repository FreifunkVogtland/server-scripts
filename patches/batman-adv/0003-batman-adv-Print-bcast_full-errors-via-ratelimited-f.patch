From: Sven Eckelmann <sven@narfation.org>
Date: Fri, 10 Jun 2016 19:22:30 +0200
Subject: [PATCH] batman-adv: Print bcast_full errors via ratelimited function

Helps to identify problems due to bcast storms. This may be related to
missing DHCP Offer replies which never end up at the client.

Signed-off-by: Sven Eckelmann <sven@narfation.org>
---
 net/batman-adv/send.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/net/batman-adv/send.c b/net/batman-adv/send.c
index f4c2fdc..bdd36fd 100644
--- a/net/batman-adv/send.c
+++ b/net/batman-adv/send.c
@@ -505,8 +505,8 @@ batadv_forw_packet_alloc(struct batadv_hard_iface *if_incoming,
 		if (queue_left == &bat_priv->batman_queue_left)
 			qname = "batman";
 
-		batadv_dbg(BATADV_DBG_BATMAN, bat_priv,
-			   "%s queue is full\n", qname);
+		net_ratelimited_function(batadv_err, bat_priv->soft_iface,
+					 "%s queue full\n", qname);
 
 		return NULL;
 	}
